# RCScheduler (Windows用Robocopyスケジューラソフト)

このアプリケーションは、Microsoft Windowsのタスクスケジューラを利用して、Robocopyによるフォルダのバックアップを簡単に設定・管理できるGUIツールです。メール通知機能や実行ログの保存、タスク履歴の有効化など、多機能なバックアップスケジューラを直感的に操作できます。

---

## 主な機能

* Robocopyによるフォルダバックアップの自動化
* タスクスケジューラを使った定期実行（毎日／毎週）
* GUIで簡単に設定・管理
* 実行結果のメール通知機能（GmailなどSMTPサーバ対応）
* タスク履歴の有効化／無効化機能（管理者権限対応）
* 実行ログの表示・保存

---

## スクリーンショット

> GUI起動時に設定できる画面（コピー元/先、オプション、スケジュール、メール設定など）

※実際の画面は `800x850` サイズで表示されます。

---

## 動作環境

* Windows 10 以降（タスクスケジューラが使用可能な環境）
* Python 3.8 以降
* 管理者権限が必要な一部機能あり（タスク履歴設定など）

---

## インストール方法

1. Pythonをインストール（[https://www.python.org）](https://www.python.org）)
2. 必要に応じて以下のパッケージをインストール：

```
pip install tk
```

※ほとんどのWindows環境では `tkinter` は標準でインストールされています。

---

## 使い方

### GUIからの起動

```bash
python main.py
```

### 初回起動時に行うこと

1. コピー元・コピー先フォルダを選択
2. Robocopyのオプションを設定（例: `/E /R:3 /W:10`）
3. 実行頻度・時刻を設定（毎日または毎週）
4. 必要に応じてメール通知を設定（SMTP、パスワード等）
5. 「タスク作成/更新」ボタンでスケジュールを登録

---

### スケジュール実行モード（自動実行）

タスクスケジューラで実行される際には、以下の引数で呼び出されます：

```bash
python main.py --scheduled
```

このモードではGUIを表示せず、設定ファイルに従ってバックアップを実行し、メール通知とログ出力を行います。

---

## 注意事項

* メール通知に使用するパスワードは設定ファイルに**平文で保存**されます。実運用では暗号化対応を検討してください。
* 一部機能（タスク履歴の有効化など）は**管理者権限**が必要です。
* Robocopyの戻り値が `0〜7` の場合は正常終了と見なされます。

---

## ライセンス

このプロジェクトはMITライセンスのもとで提供されています。

---

## 実は。。。

ソースコードは生成AI「Claude」「ChatGPT」により生成したものです。

---
