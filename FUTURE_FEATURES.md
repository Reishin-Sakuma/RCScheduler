# 未実装機能リスト

このファイルは、RCScheduler HTA版で将来実装予定の機能をまとめたものです。

---

## 1. タスク履歴設定機能

### 概要
Windowsタスクスケジューラのイベントログ機能をGUIから制御する機能。

### 詳細仕様
- Windowsタスクスケジューラの履歴機能（イベントログ）の有効化/無効化
- 現在の履歴設定状態の確認機能
- 管理者権限が必要（UACダイアログ表示）

### 必要な実装
- UIに「タスク履歴設定」セクションを追加
  - 「履歴を有効化」ボタン
  - 「履歴を無効化」ボタン
  - 「現在の設定確認」ボタン
- 実装コマンド例：
  ```batch
  # 有効化
  wevtutil set-log Microsoft-Windows-TaskScheduler/Operational /enabled:true

  # 無効化
  wevtutil set-log Microsoft-Windows-TaskScheduler/Operational /enabled:false

  # 状態確認
  wevtutil get-log Microsoft-Windows-TaskScheduler/Operational
  ```

### 参考
- Python版には実装済み
- 管理者権限での実行が必須

---

## 2. メールテスト送信機能

### 概要
設定したSMTP情報を使って、実際にテストメールを送信する機能。

### 詳細仕様
- SMTP接続テスト（実装済み）とは別に、実際のメール送信テスト
- テストメール送信後、成功/失敗を通知
- 送信先は設定されている宛先メールアドレス

### 必要な実装
- UIに「メールテスト送信」ボタンを追加
- generateMailScript関数を利用してテストメール用PowerShellスクリプトを生成
- テストメール件名：「[テスト] RCScheduler メール送信テスト」
- テスト本文：送信日時、SMTP設定情報等

### 注意点
- SMTP接続テスト（testSmtpConnection）は既に実装済み
- こちらは実際のメール送信まで行う

---

## 3. バッチスクリプトテスト後のファイル削除選択

### 概要
バッチスクリプトのテスト実行後、生成された一時ファイルを削除するか選択できる機能。

### 詳細仕様
- testRun()実行後、確認ダイアログを表示
- ユーザーが「はい」を選択した場合、一時ファイルを削除
- 削除対象：
  - 生成されたバッチファイル
  - 生成されたメールスクリプト（存在する場合）

### 必要な実装
- testRun()関数内に削除確認ダイアログを追加
- 一時ファイルパスを保持し、削除処理を実装

### 参考
- 現在は一時ファイルがそのまま残る仕様
- Python版には類似機能あり

---

## 実装優先度

1. **高**: タスク履歴設定機能（システム管理機能として重要）
2. **中**: メールテスト送信機能（ユーザビリティ向上）
3. **低**: バッチテスト後のクリーンアップ（便利機能）

---

## 備考

これらの機能はREADME.mdには記載されていません。実装完了後、README.mdに追加してください。
